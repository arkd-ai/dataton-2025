{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-11-28T13:57:39.171133Z", "invocation_id": "8f6e4bba-426e-447b-a94f-b1a41709ea30", "invocation_started_at": "2025-11-28T13:57:31.322703Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.060898Z", "completed_at": "2025-11-28T13:57:32.066219Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.066648Z", "completed_at": "2025-11-28T13:57:32.312592Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.26325178146362305, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_datos_pareja", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_datos_pareja.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_datos_pareja\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.053236Z", "completed_at": "2025-11-28T13:57:32.065052Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.094826Z", "completed_at": "2025-11-28T13:57:32.317860Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26851582527160645, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_adeudos_pasivos", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_adeudos_pasivos.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_adeudos_pasivos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.326282Z", "completed_at": "2025-11-28T13:57:32.338515Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.341449Z", "completed_at": "2025-11-28T13:57:32.424262Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09951305389404297, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_dependientes_economicos", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_dependientes_economicos.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_dependientes_economicos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.059046Z", "completed_at": "2025-11-28T13:57:32.065573Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.091432Z", "completed_at": "2025-11-28T13:57:32.471137Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4214613437652588, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_bienes_muebles", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_bienes_muebles.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_bienes_muebles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.063106Z", "completed_at": "2025-11-28T13:57:32.094409Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.097455Z", "completed_at": "2025-11-28T13:57:32.689567Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6396236419677734, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_declaraciones", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_resumen.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_declaraciones\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.430610Z", "completed_at": "2025-11-28T13:57:32.441961Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.443175Z", "completed_at": "2025-11-28T13:57:32.717500Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.29038524627685547, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_ingresos", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_ingresos.csv', union_by_name=True, filename=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_ingresos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.479653Z", "completed_at": "2025-11-28T13:57:32.490081Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.490585Z", "completed_at": "2025-11-28T13:57:32.720910Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.24428915977478027, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_inmuebles", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_bienes_inmuebles.csv', union_by_name=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_inmuebles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.330653Z", "completed_at": "2025-11-28T13:57:32.333897Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.334414Z", "completed_at": "2025-11-28T13:57:32.726687Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.39876508712768555, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_experiencia_laboral", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_experiencia_laboral.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_experiencia_laboral\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.706360Z", "completed_at": "2025-11-28T13:57:32.713169Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.714220Z", "completed_at": "2025-11-28T13:57:32.800711Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09821820259094238, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_interes_apoyos", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/interes_apoyos.csv', union_by_name=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_interes_apoyos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.732493Z", "completed_at": "2025-11-28T13:57:32.744078Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.745379Z", "completed_at": "2025-11-28T13:57:32.854764Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13093876838684082, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_interes_participacion", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/interes_participacion.csv', union_by_name=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_interes_participacion\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.756036Z", "completed_at": "2025-11-28T13:57:32.759446Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.760612Z", "completed_at": "2025-11-28T13:57:32.863852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12450766563415527, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_prestamo_comodato", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_prestamo_comodato.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_prestamo_comodato\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.741375Z", "completed_at": "2025-11-28T13:57:32.751122Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.752380Z", "completed_at": "2025-11-28T13:57:32.943274Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.21207046508789062, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_inversiones", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_inversiones.csv', union_by_name=True, filename=True, ignore_errors=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_inversiones\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.815873Z", "completed_at": "2025-11-28T13:57:32.818960Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.830740Z", "completed_at": "2025-11-28T13:57:33.017535Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2072913646697998, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.stg_s1_vehiculos", "compiled": true, "compiled_code": "\n\nselect * \nfrom read_csv_auto('/home/arkade/Documents/github/dataton-2025/system_1/csv_outputs/*/s1_vehiculos.csv', union_by_name=True)", "relation_name": "\"dataton_s1\".\"main\".\"stg_s1_vehiculos\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.917204Z", "completed_at": "2025-11-28T13:57:32.943712Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.945242Z", "completed_at": "2025-11-28T13:57:33.954652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.039116621017456, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.audit_s1_ingresos_rechazados", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_s1_ingresos_clasificados as (\n\n\nwith source as (\n    select * from \"dataton_s1\".\"main\".\"stg_s1_ingresos\"\n),\n\nclasificado as (\n    select \n        *,\n        CASE \n            WHEN ingreso_anual_neto < 0 THEN 'Valor Negativo: Ingreso Anual'\n            WHEN ingreso_mensual_neto < 0 THEN 'Valor Negativo: Ingreso Mensual'\n            WHEN remuneracion_mensual_cargo < 0 THEN 'Valor Negativo: Remuneraci\u00f3n'\n            WHEN otros_ingresos_mensuales < 0 THEN 'Valor Negativo: Otros Ingresos'\n            WHEN ingreso_anual_neto > 500000000 THEN 'Outlier Extremo: Anual > 500M'\n            WHEN ingreso_mensual_neto > 50000000 THEN 'Outlier Extremo: Mensual > 50M'\n            ELSE 'OK'\n        END as calidad_status\n    from source\n)\n\nselect * from clasificado\n) select \n    id,\n    filename as archivo_origen,\n    ingreso_mensual_neto,\n    ingreso_anual_neto,\n    remuneracion_mensual_cargo,\n    otros_ingresos_mensuales,\n    calidad_status as motivo_rechazo\nfrom __dbt__cte__int_s1_ingresos_clasificados\nwhere calidad_status != 'OK'", "relation_name": "\"dataton_s1\".\"main\".\"audit_s1_ingresos_rechazados\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.956698Z", "completed_at": "2025-11-28T13:57:32.965343Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.966105Z", "completed_at": "2025-11-28T13:57:34.538616Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5848491191864014, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.s1_ingresos_limpios", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_s1_ingresos_clasificados as (\n\n\nwith source as (\n    select * from \"dataton_s1\".\"main\".\"stg_s1_ingresos\"\n),\n\nclasificado as (\n    select \n        *,\n        CASE \n            WHEN ingreso_anual_neto < 0 THEN 'Valor Negativo: Ingreso Anual'\n            WHEN ingreso_mensual_neto < 0 THEN 'Valor Negativo: Ingreso Mensual'\n            WHEN remuneracion_mensual_cargo < 0 THEN 'Valor Negativo: Remuneraci\u00f3n'\n            WHEN otros_ingresos_mensuales < 0 THEN 'Valor Negativo: Otros Ingresos'\n            WHEN ingreso_anual_neto > 500000000 THEN 'Outlier Extremo: Anual > 500M'\n            WHEN ingreso_mensual_neto > 50000000 THEN 'Outlier Extremo: Mensual > 50M'\n            ELSE 'OK'\n        END as calidad_status\n    from source\n)\n\nselect * from clasificado\n) select \n    * exclude (filename, calidad_status)\nfrom __dbt__cte__int_s1_ingresos_clasificados\nwhere calidad_status = 'OK'", "relation_name": "\"dataton_s1\".\"main\".\"s1_ingresos_limpios\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:32.895835Z", "completed_at": "2025-11-28T13:57:32.902624Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:32.903783Z", "completed_at": "2025-11-28T13:57:37.522474Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.628046751022339, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.s1_declaraciones_perfil", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__int_s1_declaraciones_normalizadas as (\n\n\nwith source as (\n    select * from \"dataton_s1\".\"main\".\"stg_s1_declaraciones\"\n),\n\nnormalizado as (\n    select\n        id,\n        filename as archivo_origen,\n        -- Normalizaci\u00f3n de Instituci\u00f3n\n        trim(regexp_replace(\n            upper(\n                replace(replace(replace(replace(replace(institucion, \n                '\u00c1', 'A'), '\u00c9', 'E'), '\u00cd', 'I'), '\u00d3', 'O'), '\u00da', 'U')\n            ), \n            '\\s+', ' ', 'g' -- Reemplazar m\u00faltiples espacios por uno solo\n        )) as institucion_clean,\n        \n        -- Mantener valor original por si acaso\n        institucion as institucion_original,\n        \n        -- Normalizaci\u00f3n de Estado (aunque suele venir bien, aseguramos)\n        upper(trim(state)) as state_clean,\n        \n        -- Otros campos \u00fatiles\n        fecha_actualizacion,\n        tipo_declaracion\n        \n    from source\n)\n\nselect * from normalizado\n) select \n    id,\n    institucion_clean as institucion,\n    state_clean as estado,\n    tipo_declaracion,\n    archivo_origen\nfrom __dbt__cte__int_s1_declaraciones_normalizadas\nwhere institucion_clean IS NOT NULL", "relation_name": "\"dataton_s1\".\"main\".\"s1_declaraciones_perfil\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-28T13:57:37.526021Z", "completed_at": "2025-11-28T13:57:37.528523Z"}, {"name": "execute", "started_at": "2025-11-28T13:57:37.528873Z", "completed_at": "2025-11-28T13:57:39.157053Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6321356296539307, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataton_s1.s1_dataset_maestro", "compiled": true, "compiled_code": "\n\nselect \n    -- Identificadores\n    i.id,\n    p.archivo_origen,\n\n    -- Dimensiones Demogr\u00e1ficas (Normalizadas)\n    COALESCE(p.institucion, 'DESCONOCIDO') as institucion,\n    COALESCE(p.estado, i.state) as estado, -- Usar normalizado, fallback al original\n    p.tipo_declaracion,\n\n    -- M\u00e9tricas Financieras (Limpias)\n    i.remuneracion_mensual_cargo,\n    i.otros_ingresos_mensuales,\n    i.ingreso_mensual_neto,\n    i.ingreso_anual_neto\n\nfrom \"dataton_s1\".\"main\".\"s1_ingresos_limpios\" i\nleft join \"dataton_s1\".\"main\".\"s1_declaraciones_perfil\" p\n    on i.id = p.id", "relation_name": "\"dataton_s1\".\"main\".\"s1_dataset_maestro\"", "batch_results": null}], "elapsed_time": 7.216673374176025, "args": {"invocation_command": "dbt run", "require_yaml_configuration_for_mf_time_spines": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "cache_selected_only": false, "empty": false, "static_parser": true, "partial_parse_file_diff": true, "require_all_warnings_handled_by_warn_error": false, "defer": false, "log_file_max_bytes": 10485760, "partial_parse": true, "indirect_selection": "eager", "require_explicit_package_overrides_for_builtin_materializations": true, "version_check": true, "which": "run", "select": [], "quiet": false, "show_resource_report": false, "log_level": "info", "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "vars": {}, "validate_macro_args": false, "introspect": true, "printer_width": 80, "macro_debugging": false, "require_nested_cumulative_type_params": false, "print": true, "state_modified_compare_vars": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "use_fast_test_edges": false, "exclude": [], "profiles_dir": "/home/arkade/Documents/github/dataton-2025/system_1/dbt_project", "strict_mode": false, "log_format_file": "debug", "favor_state": false, "log_level_file": "debug", "require_generic_test_arguments_property": true, "log_path": "/home/arkade/Documents/github/dataton-2025/system_1/dbt_project/logs", "project_dir": "/home/arkade/Documents/github/dataton-2025/system_1/dbt_project", "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "upload_to_artifacts_ingest_api": false, "log_format": "default", "write_json": true, "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "send_anonymous_usage_stats": true}}